
# Документация для API "КлиентАналитик" и Streamlit приложения

## Описание
Проект включает два компонента:
1. **FastAPI**: для обучения моделей машинного обучения и прогнозирования.
2. **Streamlit**: для создания пользовательского интерфейса, взаимодействующего с API.

API создано с использованием FastAPI, а база данных управляется с помощью SQLAlchemy ORM.

## Используемые технологии
- **FastAPI**: Для создания RESTful API.
- **Streamlit**: Для создания интерактивного веб-интерфейса.
- **pandas**: Для обработки и анализа данных.
- **scikit-learn**: Для создания и оценки моделей машинного обучения.
- **SQLAlchemy ORM**: Для взаимодействия с базой данных в объектно-ориентированном стиле.

## FastAPI Часть

### Создание приложения
- Создает экземпляр FastAPI приложения.

### Функции

- **`get_session`**: Создает и возвращает объект сессии базы данных с использованием SQLAlchemy ORM.

- **`get_data`**: Извлекает данные из базы данных с использованием SQLAlchemy ORM, очищает их и разделяет на обучающие и тестовые выборки.

### Эндпоинты API

- **`/fit_lr`**: Обучает модель логистической регрессии, сохраняет её и возвращает ROC-AUC балл модели.

- **`/fit_svm`**: Обучает модель SVM, сохраняет её и возвращает ROC-AUC балл модели.

- **`/predict_lr`**: Использует обученную модель логистической регрессии для прогнозирования на основе данных клиента.

- **`/predict_svm`**: Использует обученную модель SVM для прогнозирования на основе данных клиента.

## Streamlit Часть

### Пользовательский интерфейс

- **Вкладка "Информация о клиентах банка"**:
  - Отображает информацию о пропусках, дубликатах, графики распределений, выбросов, матрицу корреляций и числовые характеристики данных.

- **Вкладка "Прогноз по данным клиента"**:
  - Обучает модели логистической регрессии и SVM, используя кнопки.
  - Отображает форму для ввода данных клиента и выполняет прогнозирование с помощью выбранной модели.

- **Вкладка "Визуализация результатов модели"**:
  - Позволяет настраивать порог для визуализации и отображает метрики модели.

## Установка и запуск

### Установка зависимостей
Убедитесь, что у вас установлен Python (версия 3.7 или выше). Установите зависимости, выполнив команду:

```bash
pip install -r requirements.txt
```

### Настройка базы данных
В файле `config.py` укажите URL подключения к вашей базе данных. Найдите переменную `DATABASE_URL` и замените её на строку подключения к вашей базе данных.

```python
DATABASE_URL = "postgresql://username:password@localhost/dbname"
```

### Запуск приложения
Для запуска приложения используйте `uvicorn`, выполнив следующую команду:

```bash
uvicorn app:app --reload
```

Параметр `--reload` автоматически перезагрузит сервер при изменении кода.

## Документация

API предоставляет встроенную документацию. Чтобы просмотреть её, запустите приложение и откройте [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs) в вашем веб-браузере. Здесь вы можете ознакомиться с доступными эндпоинтами и протестировать API.

## Примеры запросов

- **Получение данных о модели логистической регрессии**:

  ```http
  GET /fit_lr
  ```

- **Получение данных о модели SVM**:

  ```http
  GET /fit_svm
  ```

- **Прогнозирование с использованием модели логистической регрессии**:

  ```http
  POST /predict_lr
  Content-Type: application/json

  {
    "AGE": 30,
    "SOCSTATUS_WORK_FL": 1,
    "SOCSTATUS_PENS_FL": 0,
    "GENDER": 1,
    "CHILD_TOTAL": 2,
    "DEPENDANTS": 1,
    "PERSONAL_INCOME": 30000,
    "LOAN_NUM_TOTAL": 3,
    "LOAN_NUM_CLOSED": 1
  }
  ```

- **Прогнозирование с использованием модели SVM**:

  ```http
  POST /predict_svm
  Content-Type: application/json

  {
    "AGE": 30,
    "SOCSTATUS_WORK_FL": 1,
    "SOCSTATUS_PENS_FL": 0,
    "GENDER": 1,
    "CHILD_TOTAL": 2,
    "DEPENDANTS": 1,
    "PERSONAL_INCOME": 30000,
    "LOAN_NUM_TOTAL": 3,
    "LOAN_NUM_CLOSED": 1
  }
  ```

## Ссылки

- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [SQLAlchemy Documentation](https://docs.sqlalchemy.org/)
- [PostgreSQL Documentation](https://www.postgresql.org/docs/)

## Лицензия

Этот проект лицензирован под MIT License.

---